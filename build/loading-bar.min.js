/*! 
 * angular-loading-bar v0.9.0
 * https://chieffancypants.github.io/angular-loading-bar
 * Copyright (c) 2017 Wes Cruver
 * License: MIT
 */
!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(a){var b=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(b,c,d,e,f,g){function h(){d.cancel(k),g.completeWithSuccess(),m=0,l=0}function i(){d.cancel(k),g.complete(),m=0,l=0}function j(b){var d,e=c.get("$http"),f=a.defaults;!b.cache&&!f.cache||b.cache===!1||"GET"!==b.method&&"JSONP"!==b.method||(d=angular.isObject(b.cache)?b.cache:angular.isObject(f.cache)?f.cache:e);var g=void 0!==d&&void 0!==d.get(b.url);return void 0!==b.cached&&g!==b.cached?b.cached:(b.cached=g,g)}var k,l=0,m=0,n=g.latencyThreshold;return{request:function(a){return a.ignoreLoadingBar||j(a)||(e.$broadcast("cfpLoadingBar:loading",{url:a.url}),0===l&&(k=d(function(){g.start()},n)),l++,g.set(m/l)),a},response:function(a){return a&&a.config?(a.config.ignoreLoadingBar||j(a.config)||(m++,m>=l&&(e.$broadcast("cfpLoadingBar:loaded",{url:a.config.url,result:a}),"POST"===a.config.method&&200===a.config.status?(cosole.log("found 200 ok with post response"),h()):i(),g.set(m/l))),a):(f.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),a)},responseError:function(a){return a&&a.config?(a.config.ignoreLoadingBar||j(a.config)||(m++,m>=l?(e.$broadcast("cfpLoadingBar:loaded",{url:a.config.url,result:a}),i()):g.set(m/l)),b.reject(a)):(f.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),b.reject(a))}}}];a.interceptors.push(b)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.sucessTickTime=500,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.spinnerSuccessTemplate="<div>&#9989;You are done!!</div>",this.$get=["$injector","$document","$timeout","$rootScope",function(a,b,c,d){function e(){if(l||(l=a.get("$animate")),c.cancel(n),!s){var e=b[0],g=e.querySelector?e.querySelector(o):b.find(o)[0];g||(g=e.getElementsByTagName("body")[0]);var h=angular.element(g),i=g.lastChild&&angular.element(g.lastChild);d.$broadcast("cfpLoadingBar:started"),s=!0,w&&l.enter(p,h,i),v&&l.enter(r,h,p),f(x)}}function f(a){if(s){var b=100*a+"%";q.css("width",b),t=a,u&&(c.cancel(m),m=c(function(){g()},250))}}function g(){if(!(h()>=1)){var a=0,b=h();a=b>=0&&b<.25?(3*Math.random()+3)/100:b>=.25&&b<.65?3*Math.random()/100:b>=.65&&b<.9?2*Math.random()/100:b>=.9&&b<.99?.005:0;var c=h()+a;f(c)}}function h(){return t}function i(){t=0,s=!1}function j(){console.log("got the complete with success"),l||(l=a.get("$animate")),f(1),c.cancel(n),n=c(function(){var a=l.leave(p,i);a&&a.then&&a.then(i),l.leave(r),console.log("spinner is left"),r=angular.element(this.spinnerSuccessTemplate),console.log("new spinner template loaded",r),l.enter(r,$parent,p),console.log("new spinner template is now visible"),l.leave(r),console.log("spinner is left again"),d.$broadcast("cfpLoadingBar:completed")},800)}function k(){l||(l=a.get("$animate")),f(1),c.cancel(n),n=c(function(){var a=l.leave(p,i);a&&a.then&&a.then(i),l.leave(r),d.$broadcast("cfpLoadingBar:completed")},500)}var l,m,n,o=this.parentSelector,p=angular.element(this.loadingBarTemplate),q=p.find("div").eq(0),r=angular.element(this.spinnerTemplate),s=!1,t=0,u=this.autoIncrement,v=this.includeSpinner,w=this.includeBar,x=this.startSize;return{start:e,set:f,status:h,inc:g,complete:k,completeWithSuccess:j,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize,spinnerSuccessTemplate:this.spinnerSuccessTemplate,sucessTickTime:this.sucessTickTime}}]})}();